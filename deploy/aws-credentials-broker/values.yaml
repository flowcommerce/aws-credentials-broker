nameOverride: ""
fullnameOverride: ""

service:
  port: 8234

image:
  repository: flowcommerce/aws-credentials-broker
  pullPolicy: IfNotPresent

resources:
  limits:
    memory: "256Mi"
  requests:
    memory: "256Mi"
    cpu: .05

nodeSelector:
  karpenter/role: workers
  kubernetes.io/arch: amd64
tolerations:
  - key: "role"
    operator: "Equal"
    value: "workers"
    effect: "NoSchedule"
topologySpreadConstraints:
  schedule: "DoNotSchedule"

ingress:
  enabled: true
  gateways:
    - key: flow-io
      tld: flow.io
      hosts:
        - aws-credentials-broker.flow.io

services:
  live:
    stages:
      - deployment: live
        weight: 100
    hosts:
      - aws-credentials-broker
      - aws-credentials-broker.flow.io
    gateways:
      - mesh
      - aws-credentials-broker-flow-io

deployments:
  live:
    minReplicas: 2
    maxReplicas: 2
    maxUnavailable: 1
    disruptionBudgetEnabled: true
    targetCPUUtilizationPercentage: 80
    version: master-1
    serviceAccountName: "flow-prod-eks-production-aws-credentials-broker-sa"
    serviceAccountIamRole: "arn:aws:iam::479720515435:role/flow-prod-eks-production-role"